#!/usr/bin/env bash
set -euo pipefail

echo "ğŸ“¦ Checking for updates..."
checkupdates || true

echo "ğŸ“¸ Creating Timeshift snapshot..."
sudo timeshift --create --comments "pre-update $(date +%F_%T)" --tags D

echo "â¬†ï¸ Running paru -Syu..."
paru -Syu

echo "ğŸ” Checking if reboot is needed..."
if needrestart -p | grep -q "NEEDRESTART-KSTA: 1"; then
  echo "âš ï¸ Reboot recommended (kernel/systemd/glibc updated)."
else
  echo "âœ… No reboot strictly required, but consider weekly reboots anyway."
fi
